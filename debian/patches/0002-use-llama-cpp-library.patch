From: Mathieu Baudier <mbaudier@argeo.org>
Date: Mon, 27 Jan 2025 08:09:55 +0100
Subject: use-llama-cpp-library

Use llma.cpp shared library to build talk-llama
---
 examples/talk-llama/CMakeLists.txt | 24 +++---------------------
 1 file changed, 3 insertions(+), 21 deletions(-)

diff --git a/examples/talk-llama/CMakeLists.txt b/examples/talk-llama/CMakeLists.txt
index c15c6b5..c975d42 100644
--- a/examples/talk-llama/CMakeLists.txt
+++ b/examples/talk-llama/CMakeLists.txt
@@ -3,32 +3,14 @@ if (WHISPER_SDL2)
     set(CMAKE_CXX_STANDARD_REQUIRED ON)
 
     set(TARGET whisper-talk-llama)
-    add_executable(${TARGET} talk-llama.cpp
-        llama.cpp
-        llama-adapter.cpp
-        llama-arch.cpp
-        llama-batch.cpp
-        llama-chat.cpp
-        llama-context.cpp
-        llama-cparams.cpp
-        llama-grammar.cpp
-        llama-hparams.cpp
-        llama-impl.cpp
-        llama-kv-cache.cpp
-        llama-mmap.cpp
-        llama-model-loader.cpp
-        llama-model.cpp
-        llama-quant.cpp
-        llama-sampling.cpp
-        llama-vocab.cpp
-        unicode.cpp
-        unicode-data.cpp)
+    add_executable(${TARGET} talk-llama.cpp)
     target_include_directories(${TARGET} PRIVATE ${SDL2_INCLUDE_DIRS})
 
     if (WHISPER_CLBLAST)
         set(CLBLAST_LIBNAME clblast)
     endif ()
-    target_link_libraries(${TARGET} PRIVATE common common-sdl whisper ${SDL2_LIBRARIES} ${CLBLAST_LIBNAME} ${CMAKE_THREAD_LIBS_INIT})
+    target_link_libraries(${TARGET} PRIVATE common common-sdl whisper llama ${SDL2_LIBRARIES} ${CLBLAST_LIBNAME} ${CMAKE_THREAD_LIBS_INIT})
+    install(TARGETS ${TARGET} RUNTIME)
 
     if(WIN32)
         # It requires Windows 8.1 or later for PrefetchVirtualMemory
